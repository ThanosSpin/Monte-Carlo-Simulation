<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title></title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>





<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<pre><code class="r">#title: &quot;MCsampling&quot;
#author: &quot;Thanos Spinoulas&quot;
#date: &quot;November 2018&quot;
#output: html_document
</code></pre>

<pre><code class="r">###MC in 2d function###

###Mc in 2d function###
mc.2d &lt;-function(x, y, d, n)
  {  
  accept &lt;- 0

  data &lt;- c(x, y)

  accepts &lt;- matrix(data, 1, 2)
    for (i in 2:n) {
      y &lt;- 2*runif(1, 0, d) - 1
      x &lt;- 2*runif(1, 0 ,d) - 1

      if((x^2 + y^2) &lt;= 1) { 
    accepts &lt;- rbind(accepts, c(x,y))
    accept &lt;- accept + 1
  }
}
alpha &lt;- accept/n
par(mfrow=c(1, 2))

plot(density(accepts[ , 1]), main = &quot;&quot;)
index &lt;- seq(-1, 1, 0.1)
lines(index, 0.5*index/index, col = &quot;green&quot;)

plot(accepts, xlab=&quot;x accepts&quot;, ylab=&quot;y accepts&quot;)

return(list(alpha, accepts))
}
</code></pre>

<pre><code class="r">####Checking the system time####
set.seed(15)
system.time(mc.2d(0, 0, 1, 1000))
</code></pre>

<p><img src="figure/unnamed-chunk-57-1.png" alt="plot of chunk unnamed-chunk-57"></p>

<pre><code>##          user        system       elapsed 
## 0.05000000000 0.03000000000 0.08000000007
</code></pre>

<pre><code class="r">set.seed(16)
system.time(mc.2d(0, 0, 1, 10000))
</code></pre>

<p><img src="figure/unnamed-chunk-58-1.png" alt="plot of chunk unnamed-chunk-58"></p>

<pre><code>##    user  system elapsed 
##    0.27    0.17    0.45
</code></pre>

<pre><code class="r">set.seed(19)
system.time(mc.2d(0, 0, 1, 50000))
</code></pre>

<p><img src="figure/unnamed-chunk-59-1.png" alt="plot of chunk unnamed-chunk-59"></p>

<pre><code>##    user  system elapsed 
##    4.10    0.76    4.86
</code></pre>

<pre><code class="r">set.seed(20)
system.time(mc.2d(0, 0, 1, 100000))
</code></pre>

<p><img src="figure/unnamed-chunk-60-1.png" alt="plot of chunk unnamed-chunk-60"></p>

<pre><code>##    user  system elapsed 
##   15.86    1.58   17.51
</code></pre>

<pre><code class="r">set.seed(21)
system.time(mc.2d(0, 0, 1, 150000))
</code></pre>

<p><img src="figure/unnamed-chunk-61-1.png" alt="plot of chunk unnamed-chunk-61"></p>

<pre><code>##    user  system elapsed 
##   33.20    2.80   36.08
</code></pre>

<pre><code class="r">####calculate the mean of the generated samples (MC acceptance ratio) to verify where the chain converges####

mc_meanx_2d &lt;- function(n, d, m) {

  y &lt;- 2*runif(1, 0, d) - 1
  z &lt;- 2*runif(1, 0, d) - 1
  x &lt;- c()
  acc &lt;- c()  
  for (i in 1:m) {
    x[i] &lt;- mc.2d(y, z, d, n)[[1]] #Insert the data frame to a vector
    acc &lt;-  mc.2d(y, z, d, n)[[2]][ , 1]*mc.2d(y, z, d, n)[[2]][ , 2] # joint Uniform distribution f(x)*f(y)
    }
  z &lt;- mean(x) #finding the mean of the acceptance rate 
  return(list(x, acc)) # return the acceptance rates of the process
}
</code></pre>

<pre><code class="r">###The mean value of the 100 independent samples from the distribution is the expected value
###of the distribution
###(f(x1) + ... + f(x100))/100 =.. E[f(x)]

####We calculate the expected value of the 100 independent samples from the uniform distribution####
####in 2 dimensions

mean(z[[2]]) ###The expected value of the distribution
</code></pre>

<pre><code>## [1] 5.348442659e-06
</code></pre>

<pre><code class="r">plot(density(z[[1]]), main =&quot;&quot;) #plot probability density of z - vector (MC acceptance ratio)
abline(v = mean(z[[1]]), col = &quot;red&quot;, lwd = 1, lty = 3) # add the line of mean value
text(mean(z[[1]]), 0.1 , round(mean(z[[1]]), 3)) # add the mean value as text
</code></pre>

<p><img src="figure/unnamed-chunk-65-1.png" alt="plot of chunk unnamed-chunk-65"></p>

<pre><code class="r">index &lt;- seq(-1, 1, 0.1)

plot(density(z[[2]]), main =&quot;&quot;) #plot probability density of z - vector f(x,y)
abline(v = mean(z[[2]]), col = &quot;red&quot;, lwd = 1, lty = 3) # add the line of mean value
text(mean(z[[2]]), 0.1 , round(mean(z[[2]]), 3)) # add the mean value as text
</code></pre>

<p><img src="figure/unnamed-chunk-66-1.png" alt="plot of chunk unnamed-chunk-66"></p>

<pre><code class="r">#lines(index, 0.5*index/index, col = &quot;green&quot;) # straight line at the mean value of the Unifrom distribution
</code></pre>

<pre><code class="r">mean(z[[1]])###The expected value of the MC acceptance ratio
</code></pre>

<pre><code>## [1] 0.785449
</code></pre>

<pre><code class="r">hist(z[[1]], probability = TRUE, ylim = c(0, 120))###histogram of probabilities z (f(x1),..., f(x100))
lines(density(z[[1]]),col=&quot;red&quot;)
</code></pre>

<p><img src="figure/unnamed-chunk-68-1.png" alt="plot of chunk unnamed-chunk-68"></p>

<pre><code class="r">sd(z[[2]]) # standard deviation of joint distribution of accepted values
</code></pre>

<pre><code>## [1] 0.247492913
</code></pre>

<pre><code class="r">####We know that the estimation of the integrate is |B| = prob_estimated*(2^d) where d = 2 are the dimensions.
####So the |B| estimation is mean(z)*(2^2)

####Estimate the integrate of B (2 dimensions)####
(B_estimated &lt;- mean(z[[1]])*(2^2))
</code></pre>

<pre><code>## [1] 3.141796
</code></pre>

<pre><code class="r">##We know from the calculation of the integrate with polar coordinates (2 dimensions) 
##that that the area of probability density function upon 2d sphere (B_true) is pi/4*(4)
(B_true &lt;- pi)
</code></pre>

<pre><code>## [1] 3.141592654
</code></pre>

<pre><code class="r">##We estimated with Monte Carlo sampling of uniform distribution 
##that integrate of B is mean_estimated*(2^2) = mean(z)*4 = 3.141796 close to the true volume of 2d sphere (pi*R^2, pi for R = 1)
##Correspondingly, the area of probability density function upon 2d sphere (B_estimated) is mean(z)*2^2 
B_estimated == 2^2*mean(z[[1]])
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

<pre><code class="r">####The error of the integrate estimation is B_estimated/B_true####
(estimated_error &lt;- abs(B_true - B_estimated))
</code></pre>

<pre><code>## [1] 0.0002033464102
</code></pre>

<pre><code class="r">round(estimated_error, 4)
</code></pre>

<pre><code>## [1] 2e-04
</code></pre>

<pre><code class="r">###The error of estimation of area B  is 0.0002  or 0.01%
(estimated_error_perc &lt;- round(abs(1 - (B_estimated/B_true)), 4)*100)
</code></pre>

<pre><code>## [1] 0.01
</code></pre>

<pre><code class="r">###It is a precise algorithm (estimation error very low &lt; 1%)
</code></pre>

<pre><code class="r">####Monte Carlo in k - dimensions####

###MC in k - dimensions###
mc.d &lt;-function(n, d, k)
{  
  accept &lt;- 0

  x &lt;- (2*runif(k, 0, d) - d)
  data &lt;- c(x)
  accepts &lt;- matrix(data, 1, k)
  for (i in 1:n) {
    x &lt;- t(matrix(2*runif(k, 0, d) - d)) 
    if(sum(x^2) &lt;= 1) { 
      accepts &lt;- rbind(accepts, c(x))
      accept &lt;- accept + 1
    }
  }
  alpha &lt;- accept/n
  x1 &lt;- accepts

  par(mfrow=c(1, 2))
  plot(density(accepts[ , 1]), main = &quot;&quot;)

  abline(v = mean(accepts[, 1]), col = &quot;red&quot;, lwd = 1, lty = 3) # add the line of mean value
  text(mean(accepts[ , 1]), 0.1 , round(mean(accepts[ , 1]), 3)) # add the mean value as text

  plot(accepts, xlab=&quot;x accepts&quot;, ylab=&quot;y accepts&quot;)

  return(list(alpha, accepts))
  }
</code></pre>

<pre><code class="r">set.seed(17)
(mc.d(10000, 1, 10))
</code></pre>

<p><img src="figure/unnamed-chunk-76-1.png" alt="plot of chunk unnamed-chunk-76"></p>

<pre><code>## [[1]]
## [1] 0.002
## 
## [[2]]
##                 [,1]           [,2]           [,3]           [,4]
##  [1,] -0.68989833351  0.93675761763 -0.06347382814  0.55363930343
##  [2,] -0.04313738365 -0.01773948362  0.79992938554 -0.23645356996
##  [3,] -0.30181972869 -0.09340817528  0.12782066222 -0.14194929972
##  [4,] -0.30135888839 -0.60661308467  0.01228383649 -0.04357288033
##  [5,] -0.16929310327 -0.29277102184  0.23269208567  0.09414866753
##  [6,]  0.71694208123 -0.20436097356  0.22017081035 -0.03197488468
##  [7,] -0.20485640690  0.32287993841  0.24406195758  0.13649268216
##  [8,]  0.04746975610  0.05888795666 -0.22495024977 -0.17773769842
##  [9,] -0.27887130436 -0.20716691483 -0.01096059009  0.08529286040
## [10,]  0.13854445936 -0.42724784696  0.34269828489  0.30021331133
## [11,]  0.47877148027  0.14000655944  0.27728809789  0.11528490810
## [12,] -0.13767489884 -0.50341440877  0.19034012174  0.53099372145
## [13,]  0.13236515410 -0.21852576965  0.21305948263 -0.13914897945
## [14,] -0.31349057192  0.16379500506  0.41594919190  0.19873361941
## [15,]  0.18236481305 -0.30266266083  0.21030958556  0.56358825881
## [16,] -0.37235865416 -0.70820296695 -0.07123665977  0.08183466643
## [17,]  0.15448730113 -0.12332458515 -0.15560638998  0.16595081426
## [18,] -0.20968765253  0.17265558382  0.17999439035 -0.52216499904
## [19,] -0.28697055904 -0.12364519434 -0.19650572445  0.44001309760
## [20,] -0.15354218008  0.03679694189  0.15842710389 -0.16517897649
## [21,] -0.05467147054  0.26615081774  0.01475235587 -0.28016790003
##                 [,5]            [,6]           [,7]            [,8]
##  [1,] -0.18422851758  0.077594297007 -0.58622467285 -0.625792889390
##  [2,] -0.27783031482 -0.132598250639  0.16092900187 -0.081711507868
##  [3,]  0.08565424569  0.240012770053 -0.40252100863 -0.379481633194
##  [4,] -0.36244596634 -0.218846744858  0.10528502194 -0.162576341536
##  [5,] -0.14394735359 -0.357231716160  0.67165881488 -0.056557620410
##  [6,]  0.12545933947 -0.001188350841  0.29518127861  0.010279779322
##  [7,]  0.06209030282 -0.193154700100 -0.23111566855  0.616418775637
##  [8,] -0.44569613691 -0.036205393262  0.20825480809  0.289165047463
##  [9,] -0.33234939026 -0.078243783675  0.74456379050  0.005077560898
## [10,]  0.10718477052  0.055139785632 -0.59637905983  0.428610168863
## [11,] -0.24619504344 -0.102202443872  0.04445029143 -0.208804197144
## [12,] -0.42748530814  0.152049608994  0.10859000776 -0.176618640777
## [13,]  0.11076762062  0.188773890492  0.51352030691  0.068804345559
## [14,]  0.09212638484  0.476504566614  0.21505308338 -0.296287141740
## [15,]  0.46179917222  0.049035265576  0.03894588584 -0.495393065736
## [16,]  0.23251614813 -0.180179323070 -0.29263559496  0.189210144337
## [17,] -0.40068637952  0.179048683029  0.61471334891 -0.116407813970
## [18,]  0.08443985647 -0.347275826149  0.20363612380 -0.485141253565
## [19,] -0.38468032097 -0.055743505247 -0.32961917482 -0.231420414057
## [20,]  0.72386929533  0.071930948179  0.55489449156  0.020493347663
## [21,]  0.08563060220 -0.008863663767 -0.65597907687 -0.336061199661
##                  [,9]          [,10]
##  [1,]  0.559939376079 -0.61211214587
##  [2,]  0.134072891437 -0.32025176473
##  [3,] -0.607182729524  0.10276713036
##  [4,] -0.351943692192  0.25201372942
##  [5,] -0.088724161964 -0.32825903548
##  [6,]  0.404764642939 -0.34555210220
##  [7,]  0.455615520943  0.26009328198
##  [8,]  0.398150949273  0.29009323148
##  [9,] -0.322511921171  0.22304456588
## [10,] -0.150495246518  0.06436883658
## [11,] -0.059206498321 -0.68429075647
## [12,] -0.109648406040  0.24441207154
## [13,] -0.283612780273 -0.36898475001
## [14,]  0.104409548454 -0.51077640662
## [15,] -0.001472365111 -0.07527404046
## [16,]  0.225465367083 -0.10749127856
## [17,] -0.406477645505  0.33110856172
## [18,] -0.391126828268  0.20419442095
## [19,]  0.082952626050 -0.34655936621
## [20,]  0.135384579655  0.05957802851
## [21,] -0.412997789681  0.31719919154
</code></pre>

<pre><code class="r">###The mean value of the 100 independent samples from the distribution is the expected value
###of the distribution
###(f(x1) + ... + f(x100))/100 =.. E[f(x)]

####We calculate the expected value of the 100 independent samples from the uniform distribution####
####in 10 dimensions

# dev.off()
mean(z)###The expected value of the distribution
</code></pre>

<pre><code>## [1] 0.002515
</code></pre>

<pre><code class="r">hist(z, probability = TRUE, ylim = c(0, 1000), xlim = c(0, 0.005 ), main = &quot;MC acceptance ratio, k - 10 dimensions&quot;)###histogram of probabilities z (f(x1),..., f(x100))
lines(density(z),col=&quot;red&quot;)####The histogram of probability density is similar to normal distribution,
</code></pre>

<p><img src="figure/unnamed-chunk-78-1.png" alt="plot of chunk unnamed-chunk-78"></p>

<pre><code class="r">####We know that the estimation of the integrate is |B| = prob_estimated*(2^d) where d = 10 are the dimensions.
####So the |B| estimation is mean(z)*(2^10)

####Estimate the integrate of B (10 dimensions)####
B_estimated &lt;- mean(z)*(2^10)
B_estimated
</code></pre>

<pre><code>## [1] 2.57536
</code></pre>

<pre><code class="r">##We know from the calculation of the integrate with polar coordinates (10 dimensions) 
##that that the area of B sphere is 2.55
(B_true &lt;- (pi^(10/2))/gamma(10/2 + 1))
</code></pre>

<pre><code>## [1] 2.55016404
</code></pre>

<pre><code class="r">##We estimated with Monte Carlo sampling of uniform distribution 
##that integrate of B is 2.516679 close to the true volume of 10d sphere

####The error of the integrate estimation is B_estimated/B_true####
round((estimated_error &lt;- abs(B_true - B_estimated)), 3)
</code></pre>

<pre><code>## [1] 0.025
</code></pre>

<pre><code class="r">###The error of estimation of area B  is 0.025 or 0.99%
(estimated_error_perc &lt;- round(abs(1 - (B_estimated/B_true)), 4)*100)
</code></pre>

<pre><code>## [1] 0.99
</code></pre>

<pre><code class="r">####Calculation of the number of samples####

sd(z) # standard deviation from 100 iterations of 10.000 samples
</code></pre>

<pre><code>## [1] 0.0004404715104
</code></pre>

<pre><code class="r">sd(z)/sqrt(10000) #estimation error
</code></pre>

<pre><code>## [1] 4.404715104e-06
</code></pre>

<pre><code class="r">cumprob &lt;- pnorm(z, mean(z), sd(z)) #cumulative probability of normal distribution
# with mean = mean(z) and sd = sd(z)

sd(cumprob) # standard deviation of cumulative probability for expected mean value of
</code></pre>

<pre><code>## [1] 0.2788745833
</code></pre>

<pre><code class="r"># MC acceptance ratio
</code></pre>

<pre><code class="r">sd(cumprob)/sqrt(10000) #estimaton error &lt; 4*10^-3
</code></pre>

<pre><code>## [1] 0.002788745833
</code></pre>

<pre><code class="r">(round((sd(cumprob)/sqrt(10000))/(sd(z)/sqrt(10000)), 0)) # for precision &gt; 2*10^-3 (or error &lt; 2*10^-3)
</code></pre>

<pre><code>## [1] 633
</code></pre>

<pre><code class="r"># we have to increase six hundred times the samples of the iterating process, that means, 
#6 million samples in each iterating process
</code></pre>

<pre><code class="r">####Calculate the running time depending on the number of samples (dimensions k = 10)####

mc.10d_run_time &lt;-function(number_accepts, d, k)
{  

  accept &lt;- 0 #counter for number of accepts
  data &lt;- c(2*runif(k, 0, d) - 1) #vector of simulated point
  accepts &lt;- matrix(data, 1, k)  #matrix includes the first point of the process

    n &lt;- 0 # counter for number of steps

    while(accept &lt; number_accepts + 1) { #while loop (accept &lt; number of accepts)
        n &lt;- n + 1 #incremental counter for number of steps
        x &lt;- t(matrix(2*runif(k, 0, d) - 1)) # new simulated point
       if(sum(x^2) &lt;= 1) { #if x is inside the sphere
      accepts &lt;- rbind(accepts, x) #x is inserted into the matrix of accepts
      accept &lt;- accept + 1 #and accept counter is increasing by 1

      }
      }
    alpha &lt;- accept/n # probability of accepting points
  return(n) #return number of steps
  }


set.seed(22)
number_steps &lt;- (mc.10d_run_time(1000, 1, 10))
</code></pre>

<pre><code class="r">start.time &lt;- Sys.time()
set.seed(31)
for (i in seq(2000, 10000, by = 1000)) {
number_steps &lt;- cbind(number_steps, mc.10d_run_time(i, 1, 10))
}
end.time &lt;- Sys.time()
(time.taken &lt;- end.time - start.time)
</code></pre>

<pre><code>## Time difference of 5.603825565 mins
</code></pre>

<pre><code class="r">slope &lt;- data.frame(t(number_steps))

c(seq(1, nrow(slope), by = 1))
</code></pre>

<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10
</code></pre>

<pre><code class="r">slope$accepts &lt;- c(seq(1000, nrow(slope)*1000, by = 1000))

names(slope)[which(names(slope) %in% c(&quot;t.number_steps.&quot;))] &lt;- c(&quot;number_steps&quot;)

plot(slope$number_steps, slope$accepts, xlab = &quot;Number of Steps&quot;, ylab = &quot;Accepts&quot;, main = &quot;Slope&quot;)
</code></pre>

<p><img src="figure/unnamed-chunk-90-1.png" alt="plot of chunk unnamed-chunk-90"></p>

<pre><code class="r">y &lt;- lm(slope$accepts ~ slope$number_steps, data = slope)
summary(y)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = slope$accepts ~ slope$number_steps, data = slope)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -195.23982  -21.24470  -10.84453   27.69105  248.43828 
## 
## Coefficients:
##                         Estimate    Std. Error  t value   Pr(&gt;|t|)    
## (Intercept)        -2.280627e+00  8.216513e+01 -0.02776    0.97854    
## slope$number_steps  2.484692e-03  3.289679e-05 75.52995 1.0521e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 120.1721 on 8 degrees of freedom
## Multiple R-squared:  0.9985996,  Adjusted R-squared:  0.9984246 
## F-statistic: 5704.773 on 1 and 8 DF,  p-value: 1.05214e-12
</code></pre>

<pre><code class="r">y$coefficients[2]###the coeff of linear regression is the expected mean value of probability density function
</code></pre>

<pre><code>## slope$number_steps 
##     0.002484692455
</code></pre>

<pre><code class="r">slope$Probability &lt;- slope$accepts/slope$number_steps # expected mean value of probability density function 
slope$Exp_Time &lt;- round(1/slope$Probability, 0) # expected mean time for having a point inside the sphere (return to the same state X = 1)
slope$Constant &lt;- 1/slope$accepts
mean(slope$Constant)
</code></pre>

<pre><code>## [1] 0.0002928968254
</code></pre>

<pre><code class="r">qqnorm(slope$accepts)###normal probability q-q plot
qqline(slope$accepts)###added line in normal probability q-q plot
</code></pre>

<p><img src="figure/unnamed-chunk-94-1.png" alt="plot of chunk unnamed-chunk-94"></p>

<pre><code class="r">predict(y, newdata = slope)
</code></pre>

<pre><code>## number_steps            X          X.1          X.2          X.3 
##  1011.911200  1992.542287  3009.777862  3965.564509  5014.099755 
##          X.4          X.5          X.6          X.7          X.8 
##  5937.781691  7195.239817  8023.626343  8751.561722 10097.894813
</code></pre>

<pre><code class="r">slope$accepts
</code></pre>

<pre><code>##  [1]  1000  2000  3000  4000  5000  6000  7000  8000  9000 10000
</code></pre>

<pre><code class="r">####The expected Time T####

###The expected Time T Monte Carlo has to run (number of samples) in order to have X accepts

c &lt;- 1/X ###calculated in slope data frame
d &lt;- 10 ##dimensions

###For instance for X = 20,000 (accepts - points inside the 10d sphere)###
X &lt;- 20000

###The slope of the regresion line between accepts and number of steps is the
###Expected value of the probability density function
(expected_time &lt;- round(c*X/y$coefficients[2], 0))###the expected mean time for each accepting point 
</code></pre>

<pre><code>## slope$number_steps 
##                402
</code></pre>

<pre><code class="r">###As a result the expected running time in order to have 20,000 accepting points is: 
expected_time*20000
</code></pre>

<pre><code>## slope$number_steps 
##            8040000
</code></pre>

<pre><code class="r">new_row &lt;- c(expected_time*X, X, 1/expected_time, expected_time, c) # new row of slope data frame (values for each column)

#### Adding the predicted number of steps in slope data frame ####
slope &lt;- rbind.data.frame(slope, new_row)
View(slope)
</code></pre>

<pre><code class="r">####Histogram of expected value of y (10 iterations of 100 samples with 10000 observations, k - dimensions = 10)####
hist(y, breaks = 5, freq = FALSE, ylim = c(0, 800))
lines(density(y),col=&quot;red&quot;)####The histogram of probability density is similar to normal distribution,
</code></pre>

<p><img src="figure/unnamed-chunk-101-1.png" alt="plot of chunk unnamed-chunk-101"></p>

<pre><code class="r">apply(y, 2, var)
</code></pre>

<pre><code>##  [1] 2.696969697e-07 2.363191919e-07 2.752272727e-07 1.945161616e-07
##  [5] 2.657080808e-07 2.949202020e-07 2.644080808e-07 2.154050505e-07
##  [9] 2.173737374e-07 2.213121212e-07
</code></pre>

<pre><code class="r">summary(y)###summary statistics of y
</code></pre>

<pre><code>##        V1                 V2                 V3          
##  Min.   :0.001200   Min.   :0.001400   Min.   :0.001400  
##  1st Qu.:0.002200   1st Qu.:0.002300   1st Qu.:0.002000  
##  Median :0.002500   Median :0.002600   Median :0.002350  
##  Mean   :0.002480   Mean   :0.002538   Mean   :0.002405  
##  3rd Qu.:0.002725   3rd Qu.:0.002800   3rd Qu.:0.002700  
##  Max.   :0.004000   Max.   :0.003900   Max.   :0.003900  
##        V4                 V5                 V6          
##  Min.   :0.001400   Min.   :0.001400   Min.   :0.001200  
##  1st Qu.:0.002300   1st Qu.:0.002100   1st Qu.:0.002100  
##  Median :0.002600   Median :0.002400   Median :0.002500  
##  Mean   :0.002577   Mean   :0.002457   Mean   :0.002527  
##  3rd Qu.:0.002825   3rd Qu.:0.002725   3rd Qu.:0.002900  
##  Max.   :0.003700   Max.   :0.004300   Max.   :0.003900  
##        V7                 V8                 V9         
##  Min.   :0.001300   Min.   :0.001400   Min.   :0.00100  
##  1st Qu.:0.002200   1st Qu.:0.002200   1st Qu.:0.00220  
##  Median :0.002400   Median :0.002400   Median :0.00250  
##  Mean   :0.002494   Mean   :0.002457   Mean   :0.00248  
##  3rd Qu.:0.002800   3rd Qu.:0.002800   3rd Qu.:0.00280  
##  Max.   :0.003800   Max.   :0.003400   Max.   :0.00350  
##       V10          
##  Min.   :0.001400  
##  1st Qu.:0.002100  
##  Median :0.002500  
##  Mean   :0.002499  
##  3rd Qu.:0.002800  
##  Max.   :0.003700
</code></pre>

<pre><code class="r">###Validation of histogram (probability density value)
h &lt;- hist(y, breaks = 5, freq = FALSE)
</code></pre>

<p><img src="figure/unnamed-chunk-104-1.png" alt="plot of chunk unnamed-chunk-104"></p>

<pre><code class="r">sum(h$density)
</code></pre>

<pre><code>## [1] 2000
</code></pre>

<pre><code class="r">unique(zapsmall(diff(h$breaks)))
</code></pre>

<pre><code>## [1] 5e-04
</code></pre>

<pre><code class="r">unique(zapsmall(diff(h$breaks)))*sum(h$density)
</code></pre>

<pre><code>## [1] 1
</code></pre>

<pre><code class="r">### Normality function ####
normality &lt;- function (x, k) { 
  y &lt;- (x - (B_true/2^k))/sd(x)
return(y)
  }
</code></pre>

<pre><code class="r">### asymptotic variance in each iteration ###
apply(normality(y[ , ], 10), 2, var)
</code></pre>

<pre><code>##  [1] 1.0991377037 0.9631080922 1.1216762016 0.7927417481 1.0828811689
##  [6] 1.2019338371 1.0775830782 0.8778734624 0.8858967560 0.9019474597
</code></pre>

<pre><code class="r">### Histogram of y ####
hist(normality(y[ , ], 10) ,freq = FALSE, main = &quot;Normalization of Expected Mean 
     Values (k - 10 dimensions)&quot;, xlab = &quot;&quot;)

### Add curved line (density) ###
lines(density(normality(y[ , ], 10)),col=&quot;red&quot;)

### set seed for generating the same sample ###
set.seed(321)

### add line with sampling from Normal disribution ###
lines(density(rnorm(1000)), col = &quot; green&quot;, lty = 3)
</code></pre>

<p><img src="figure/unnamed-chunk-108-1.png" alt="plot of chunk unnamed-chunk-108"></p>

</body>

</html>
